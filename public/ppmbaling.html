<!DOCTYPE html>
<html lang="ms">
<head>
  <meta charset="UTF-8">
  <title>PPM Baling | Persekutuan Pengakap Daerah Baling</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="icon" type="image/png" href="assets/favicon.png">
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 text-gray-800 min-h-screen flex flex-col">

  <main class="flex-grow">


<!-- ================= HEADER ================= -->
<header class="bg-green-900 text-white sticky top-0 z-50 shadow">
  <div class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">

    <div class="flex items-center gap-4">
      <img src="assets/logo.png" class="h-14" alt="Logo Pengakap">
      <div>
        <p class="text-xs uppercase opacity-80">Portal Rasmi</p>
        <h1 class="font-bold text-lg md:text-xl">
          Persekutuan Pengakap Daerah Baling
        </h1>
        <p class="text-xs italic opacity-90">Bersedia ¬∑ Berkhidmat</p>
      </div>
    </div>

    <nav class="hidden md:flex items-center gap-6 text-sm font-semibold">
      <a href="index.html" class="hover:text-yellow-300">Utama</a>
      <a href="pengenalan.html" class="hover:text-yellow-300">Pengenalan</a>
      <a href="ppmbaling.html"
         class="text-yellow-400 border-b-2 border-yellow-400 pb-1">
         PPMD Baling
      </a>
      <a href="aktiviti.html" class="hover:text-yellow-300">Aktiviti</a>
      <a href="muatturun.html" class="hover:text-yellow-300">Muat Turun</a>
      <a href="hubungi.html" class="hover:text-yellow-300">Hubungi Kami</a>
    </nav>
  </div>
</header>

<!-- ================= TAJUK ================= -->
<section class="max-w-7xl mx-auto px-6 mt-10">
<h2 class="text-2xl font-bold text-green-900 mb-2">Pasukan Pengakap Malaysia Daerah Baling</h2>
<p class="text-gray-600 mb-8 max-w-3xl">
Maklumat rasmi berkaitan sejarah, prinsip, struktur organisasi dan nilai asas kepengakapan.
</p>

<!-- ================= DASHBOARD GRID ================= -->
<section class="max-w-7xl mx-auto px-6 mt-10">

  <div class="grid md:grid-cols-2 gap-6">

    <!-- Carta Organisasi -->
    <a href="#"
       class="bg-slate-900 text-white rounded-xl p-6 shadow-lg hover:shadow-2xl transition">
      <div class="flex items-center gap-4">
        <div class="bg-slate-800 p-3 rounded-lg text-xl">üìä</div>
        <h3 class="text-lg font-semibold">Carta Organisasi PPM</h3>
      </div>
    </a>

    <!-- Unit Pengakap -->
    <a href="#"
       class="bg-slate-900 text-white rounded-xl p-6 shadow-lg hover:shadow-2xl transition">
      <div class="flex items-center gap-4">
        <div class="bg-slate-800 p-3 rounded-lg text-xl">üèïÔ∏è</div>
        <h3 class="text-lg font-semibold">Unit Pengakap Daerah</h3>
      </div>
    </a>

    <!-- Senarai Pemimpin -->
    <a href="#"
       class="bg-white rounded-xl p-6 shadow hover:shadow-md transition flex items-center justify-between">
      <div class="flex items-center gap-4">
        <div class="bg-gray-100 p-3 rounded-lg text-xl">üë§</div>
        <span class="font-medium">Senarai Pemimpin</span>
      </div>
      <span class="text-gray-400">‚Ä∫</span>
    </a>

    <!-- Dokumen Rasmi -->
    <a href="#"
       class="bg-white rounded-xl p-6 shadow hover:shadow-md transition flex items-center justify-between">
      <div class="flex items-center gap-4">
        <div class="bg-gray-100 p-3 rounded-lg text-xl">üìÇ</div>
        <span class="font-medium">Dokumen Rasmi</span>
      </div>
      <span class="text-gray-400">‚Ä∫</span>
    </a>

    <!-- üî• Maklumat Sekolah (Trigger Firestore Section) -->
    <a href="#"
       onclick="showSection('maklumat-sekolah'); return false;"
       class="bg-white rounded-xl p-6 shadow hover:shadow-md transition flex items-center justify-between md:col-span-2">

      <div class="flex items-center gap-4">
        <div class="bg-gray-100 p-3 rounded-lg text-xl">üè´</div>
        <span class="font-medium">Maklumat Zon & Sekolah</span>
      </div>

      <span class="text-gray-400">‚Ä∫</span>
    </a>

  </div>

</section>

<!-- ================= DASHBOARD MAKLUMAT SEKOLAH ================= -->

<button id="importBtn"
  class="hidden mb-6 bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded shadow">
  IMPORT DATA SEKOLAH (JSON)
</button>

<section id="maklumat-sekolah"
  class="content-section hidden max-w-7xl mx-auto px-6 mt-16">

  <h3 class="text-2xl font-bold text-green-900 mb-6">
    Maklumat Sekolah Daerah Baling
  </h3>

  <button onclick="hideSection('maklumat-sekolah')"
    class="mb-6 text-sm bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded">
    ‚Üê Kembali ke PPM Baling
  </button>

  <!-- STATISTIK -->
  <div class="grid md:grid-cols-3 gap-6 mb-10">

    <div class="bg-white rounded-xl shadow p-6 text-center border-t-4 border-slate-800">
      <h2 class="text-4xl font-bold text-slate-800">76</h2>
      <p class="text-sm text-gray-600 mt-2 uppercase">Jumlah Keseluruhan</p>
    </div>

    <div class="bg-white rounded-xl shadow p-6 text-center border-t-4 border-green-600">
      <h2 class="text-4xl font-bold text-green-600">60</h2>
      <p class="text-sm text-gray-600 mt-2 uppercase">Sekolah Rendah</p>
    </div>

    <div class="bg-white rounded-xl shadow p-6 text-center border-t-4 border-blue-600">
      <h2 class="text-4xl font-bold text-blue-600">16</h2>
      <p class="text-sm text-gray-600 mt-2 uppercase">Sekolah Menengah</p>
    </div>

  </div>

  <!-- FILTER -->
  <div class="bg-white rounded-xl shadow p-6 mb-10">
    <input type="text"
  id="searchInput"
  placeholder="üîç Cari Nama Sekolah, Kod atau PGB..."
  class="w-full border rounded-lg px-4 py-2 mb-4">

<div class="grid md:grid-cols-4 gap-4">
  <select id="filterDun" class="border rounded-lg px-4 py-2">
    <option value="">Semua DUN</option>
  </select>

  <select id="filterJenis" class="border rounded-lg px-4 py-2">
    <option value="">Semua Jenis</option>
  </select>

  <select id="filterKategori" class="border rounded-lg px-4 py-2">
    <option value="">Semua Kategori</option>
  </select>

  <select id="filterLokasi" class="border rounded-lg px-4 py-2">
    <option value="">Semua Lokasi</option>
  </select>
</div>

  </div>

  <!-- GRID SEKOLAH (üî• PENTING) -->
  <div id="sekolah-grid"
       class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 pb-16">
  </div>

</section>

</main>

<!-- ================= FOOTER ================= -->
<footer class="bg-green-900 text-white text-center text-sm py-6 mt-auto">
  ¬© 2026 Persekutuan Pengakap Daerah Baling
</footer>

<script type="module">
import { initializeApp } 
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";

import { 
  getFirestore, 
  collection, 
  getDocs, 
  addDoc 
} 
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

/* ================= FIREBASE CONFIG ================= */

const firebaseConfig = {
  apiKey: "AIzaSyAU-mdQWJkF9tiyrl6ZxJeGTyfHG2TYSVU",
  authDomain: "ppmdaerahbaling.firebaseapp.com",
  projectId: "ppmdaerahbaling",
  storageBucket: "ppmdaerahbaling.firebasestorage.app",
  messagingSenderId: "336046440771",
  appId: "1:336046440771:web:f26f1be4acc6ec265d6ff6"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

let semuaSekolah = [];

/* ================= LOAD DATA ================= */

window.loadSekolah = async function() {

  const grid = document.getElementById("sekolah-grid");
  if (!grid) return;

  grid.innerHTML = `
    <div class="col-span-full text-center py-10 text-gray-500">
      Memuatkan data sekolah...
    </div>
  `;

  try {

    const snapshot = await getDocs(collection(db, "sekolah"));
    semuaSekolah = [];

    snapshot.forEach(doc => {
      semuaSekolah.push(doc.data());
    });

    isiDropdown();
    paparSekolah();
    kiraStatistik();

  } catch (error) {
    console.error(error);
    grid.innerHTML = `
      <div class="col-span-full text-center py-10 text-red-500">
        Ralat memuatkan data.
      </div>
    `;
  }
};

/* ================= STATISTIK AUTO ================= */

function kiraStatistik() {

  const total = semuaSekolah.length;
  const rendah = semuaSekolah.filter(s => 
    (s.jenis || "").toLowerCase().includes("sk") ||
    (s.kategori || "").toLowerCase().includes("rendah")
  ).length;

  const menengah = semuaSekolah.filter(s => 
    (s.jenis || "").toLowerCase().includes("sm")
  ).length;

  document.querySelectorAll(".stat-total")[0].textContent = total;
  document.querySelectorAll(".stat-rendah")[0].textContent = rendah;
  document.querySelectorAll(".stat-menengah")[0].textContent = menengah;
}

/* ================= DROPDOWN ================= */

function isiDropdown() {

  const dunSet = new Set();
  const jenisSet = new Set();
  const kategoriSet = new Set();
  const lokasiSet = new Set();

  semuaSekolah.forEach(s => {
    if (s.dun) dunSet.add(s.dun);
    if (s.jenis) jenisSet.add(s.jenis);
    if (s.kategori) kategoriSet.add(s.kategori);
    if (s.lokasi) lokasiSet.add(s.lokasi);
  });

  isiOption("filterDun", dunSet);
  isiOption("filterJenis", jenisSet);
  isiOption("filterKategori", kategoriSet);
  isiOption("filterLokasi", lokasiSet);
}

function isiOption(id, dataSet) {

  const select = document.getElementById(id);

  const firstOption = select.options[0].outerHTML;
  select.innerHTML = firstOption;

  [...dataSet].sort().forEach(value => {
    const option = document.createElement("option");
    option.value = value;
    option.textContent = value;
    select.appendChild(option);
  });
}

/* ================= PAPAR SEKOLAH ================= */

function paparSekolah() {

  const grid = document.getElementById("sekolah-grid");

  const keyword = document.getElementById("searchInput").value.toLowerCase();
  const dun = document.getElementById("filterDun").value;
  const jenis = document.getElementById("filterJenis").value;
  const kategori = document.getElementById("filterKategori").value;
  const lokasi = document.getElementById("filterLokasi").value;

  const filtered = semuaSekolah.filter(s => {

    const matchSearch =
      (s.nama || "").toLowerCase().includes(keyword) ||
      (s.kod || "").toLowerCase().includes(keyword) ||
      (s.pgb || "").toLowerCase().includes(keyword);

    const matchDun = !dun || s.dun === dun;
    const matchJenis = !jenis || s.jenis === jenis;
    const matchKategori = !kategori || s.kategori === kategori;
    const matchLokasi = !lokasi || s.lokasi === lokasi;

    return matchSearch && matchDun && matchJenis && matchKategori && matchLokasi;
  });

  grid.innerHTML = "";

  if (filtered.length === 0) {
    grid.innerHTML = `
      <div class="col-span-full text-center text-gray-400 py-10">
        Tiada sekolah dijumpai.
      </div>
    `;
    return;
  }

  filtered.forEach(s => {

    grid.innerHTML += `
      <div class="bg-white rounded-xl shadow hover:shadow-lg transition p-6">
        <div class="flex items-center gap-4">
          <img src="${s.logo || 'assets/logo.png'}"
               class="h-14 w-14 object-contain">
          <div>
            <h3 class="font-bold text-lg text-slate-800">
              ${s.nama}
            </h3>
            <span class="text-xs bg-yellow-400 text-black px-2 py-1 rounded">
              ${s.kod}
            </span>
          </div>
        </div>

        <div class="mt-4 text-sm text-gray-700">
          üë§ ${s.pgb || "-"} <br>
          üìû ${s.telefon_pgb || s.telefon || "-"}
        </div>

        <div class="mt-4 text-sm text-red-500">
          üìç ${s.lokasi || "-"}, ${s.dun || "-"}
        </div>
      </div>
    `;
  });
}

/* ================= IMPORT JSON (OPTIONAL) ================= */

window.importJSON = async function() {

  if (!confirm("Pastikan koleksi sekolah kosong. Teruskan import?")) return;

  try {

    const response = await fetch("sekolah.json");
    const data = await response.json();

    for (const item of data) {

      const sekolah = {
        kod: item["Kod Sekolah"] || "",
        nama: item["Nama Sekolah"] || "",
        kategori: item["Kategori"] || "",
        jenis: item["Jenis"] || "",
        dun: item["DUN"] || "",
        lokasi: item["Lokasi"] || "",
        alamat: item["Alamat"] || "",
        telefon: item["Telefon Sekolah"] || "",
        emel: item["Emel Sekolah"] || "",
        pgb: item["Nama PGB"] || "",
        telefon_pgb: item["Telefon PGB"] || "",
        emel_pgb: item["Emel PGB"] || "",
        logo: "assets/logo.png"
      };

      await addDoc(collection(db, "sekolah"), sekolah);
    }

    alert("‚úÖ Import selesai!");
    loadSekolah();

  } catch (error) {
    console.error(error);
    alert("‚ùå Ralat import.");
  }
};

/* ================= EVENT LISTENER ================= */

document.getElementById("searchInput")
  .addEventListener("input", paparSekolah);

document.getElementById("filterDun")
  .addEventListener("change", paparSekolah);

document.getElementById("filterJenis")
  .addEventListener("change", paparSekolah);

document.getElementById("filterKategori")
  .addEventListener("change", paparSekolah);

document.getElementById("filterLokasi")
  .addEventListener("change", paparSekolah);

</script>

</body>
</html>
